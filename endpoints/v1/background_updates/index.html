
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.8">
    
    
      
        <title>Background Updates - Matrix Admin Sdk</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.644de097.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.e6a45f82.min.css">
        
          
          
          <meta name="theme-color" content="#e92063">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="pink" data-md-color-accent="pink">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#background-updates" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Matrix Admin Sdk" class="md-header__button md-logo" aria-label="Matrix Admin Sdk" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Matrix Admin Sdk
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Background Updates
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Matrix Admin Sdk" class="md-nav__button md-logo" aria-label="Matrix Admin Sdk" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Matrix Admin Sdk
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Matrix Admin SDK
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Endpoints
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Endpoints" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Endpoints
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_1" type="checkbox" id="__nav_2_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2_1">
          v1
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="v1" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          v1
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../account_validity/" class="md-nav__link">
        Account Validity
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Background Updates
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Background Updates
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#endpoints" class="md-nav__link">
    Endpoints
  </a>
  
    <nav class="md-nav" aria-label="Endpoints">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#backgroundupdates" class="md-nav__link">
    BackgroundUpdates
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matrix_admin_sdk.endpoints.v1.background_updates.BackgroundUpdates" class="md-nav__link">
    matrix_admin_sdk.endpoints.v1.background_updates.BackgroundUpdates
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matrix_admin_sdk.endpoints.v1.background_updates.BackgroundUpdates.enabled" class="md-nav__link">
    enabled()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matrix_admin_sdk.endpoints.v1.background_updates.BackgroundUpdates.run" class="md-nav__link">
    run()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matrix_admin_sdk.endpoints.v1.background_updates.BackgroundUpdates.status" class="md-nav__link">
    status()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models" class="md-nav__link">
    Models
  </a>
  
    <nav class="md-nav" aria-label="Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#currentupdate" class="md-nav__link">
    CurrentUpdate
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matrix_admin_sdk.models.background_updates.CurrentUpdate" class="md-nav__link">
    matrix_admin_sdk.models.background_updates.CurrentUpdate
  </a>
  
    <nav class="md-nav" aria-label="matrix_admin_sdk.models.background_updates.CurrentUpdate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#statusmodel" class="md-nav__link">
    StatusModel
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matrix_admin_sdk.models.background_updates.StatusModel" class="md-nav__link">
    matrix_admin_sdk.models.background_updates.StatusModel
  </a>
  
    <nav class="md-nav" aria-label="matrix_admin_sdk.models.background_updates.StatusModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enabledmodel" class="md-nav__link">
    EnabledModel
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matrix_admin_sdk.models.background_updates.EnabledModel" class="md-nav__link">
    matrix_admin_sdk.models.background_updates.EnabledModel
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../delete_group/" class="md-nav__link">
        Delete Group
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../delete_local_media/" class="md-nav__link">
        Delete Local Media
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../edit_room_membership/" class="md-nav__link">
        Edit Room Membership
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../event_reports/" class="md-nav__link">
        Event Reports
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../purge_history/" class="md-nav__link">
        Purge History
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../purge_remote_media/" class="md-nav__link">
        Purge Remote Media
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../quarantine_media/" class="md-nav__link">
        Quarantine Media
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../querying_media/" class="md-nav__link">
        Querying Media
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../register_user/" class="md-nav__link">
        Register Users
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../registration_tokens/" class="md-nav__link">
        Registration Tokens
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rooms/" class="md-nav__link">
        Rooms
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../forward_extremities/" class="md-nav__link">
        Forward Extremities
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../server_notices/" class="md-nav__link">
        Server Notices
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_media_statistics/" class="md-nav__link">
        User Media Statistics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user/" class="md-nav__link">
        User
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_rate_limits/" class="md-nav__link">
        User Rate Limits
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../server/" class="md-nav__link">
        Server
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../federation/" class="md-nav__link">
        Federation
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#endpoints" class="md-nav__link">
    Endpoints
  </a>
  
    <nav class="md-nav" aria-label="Endpoints">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#backgroundupdates" class="md-nav__link">
    BackgroundUpdates
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matrix_admin_sdk.endpoints.v1.background_updates.BackgroundUpdates" class="md-nav__link">
    matrix_admin_sdk.endpoints.v1.background_updates.BackgroundUpdates
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matrix_admin_sdk.endpoints.v1.background_updates.BackgroundUpdates.enabled" class="md-nav__link">
    enabled()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matrix_admin_sdk.endpoints.v1.background_updates.BackgroundUpdates.run" class="md-nav__link">
    run()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matrix_admin_sdk.endpoints.v1.background_updates.BackgroundUpdates.status" class="md-nav__link">
    status()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models" class="md-nav__link">
    Models
  </a>
  
    <nav class="md-nav" aria-label="Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#currentupdate" class="md-nav__link">
    CurrentUpdate
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matrix_admin_sdk.models.background_updates.CurrentUpdate" class="md-nav__link">
    matrix_admin_sdk.models.background_updates.CurrentUpdate
  </a>
  
    <nav class="md-nav" aria-label="matrix_admin_sdk.models.background_updates.CurrentUpdate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#statusmodel" class="md-nav__link">
    StatusModel
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matrix_admin_sdk.models.background_updates.StatusModel" class="md-nav__link">
    matrix_admin_sdk.models.background_updates.StatusModel
  </a>
  
    <nav class="md-nav" aria-label="matrix_admin_sdk.models.background_updates.StatusModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enabledmodel" class="md-nav__link">
    EnabledModel
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matrix_admin_sdk.models.background_updates.EnabledModel" class="md-nav__link">
    matrix_admin_sdk.models.background_updates.EnabledModel
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="background-updates">Background Updates<a class="headerlink" href="#background-updates" title="Permanent link">&para;</a></h1>
<h2 id="endpoints">Endpoints<a class="headerlink" href="#endpoints" title="Permanent link">&para;</a></h2>
<h3 id="backgroundupdates"><a href="https://matrix-org.github.io/synapse/latest/usage/administration/admin_api/background_updates.html">BackgroundUpdates</a><a class="headerlink" href="#backgroundupdates" title="Permanent link">&para;</a></h3>


  <div class="doc doc-object doc-class">

<a id="matrix_admin_sdk.endpoints.v1.background_updates.BackgroundUpdates"></a>
    <div class="doc doc-contents first">

      <p>This API allows a server administrator to manage the background
updates being run against the database.</p>

        <details class="quote">
          <summary>Source code in <code>matrix_admin_sdk/endpoints/v1/background_updates.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">BackgroundUpdates</span><span class="p">(</span><span class="n">Endpoint</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This API allows a server administrator to manage the background</span>
<span class="sd">    updates being run against the database.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">status</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StatusModel</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This API gets the current status of the background updates.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">(</span><span class="s2">&quot;background_updates/status&quot;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">RequestMethods</span><span class="o">.</span><span class="n">GET</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">StatusModel</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">enabled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">enabled</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EnabledModel</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This API allows pausing background updates.</span>

<span class="sd">        Background updates should not be paused for significant periods of time,</span>
<span class="sd">        as this can affect the performance of Synapse.</span>

<span class="sd">        Note: This won&#39;t persist over restarts.</span>

<span class="sd">        Note: This won&#39;t cancel any update query that is currently running.</span>
<span class="sd">        This is usually fine since most queries are short lived, except for</span>
<span class="sd">        CREATE INDEX background updates which won&#39;t be cancelled once started.</span>
<span class="sd">        Args:</span>
<span class="sd">            enabled: sets whether the background updates are enabled or disabled.</span>

<span class="sd">        Returns: The new status of the background updates.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">(</span><span class="s2">&quot;background_updates/enabled&quot;</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;enabled&quot;</span><span class="p">:</span> <span class="n">enabled</span><span class="p">}</span>
        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">RequestMethods</span><span class="o">.</span><span class="n">POST</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
        <span class="n">res</span><span class="p">:</span> <span class="n">EnabledModel</span> <span class="o">=</span> <span class="n">EnabledModel</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">job_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This API schedules a specific background update to run.</span>
<span class="sd">        The job starts immediately after calling the API.</span>

<span class="sd">        Args:</span>
<span class="sd">            job_name: A string which job to run. Valid values are:</span>
<span class="sd">                - &quot;populate_stats_process_rooms&quot;: Recalculate the stats for all rooms.</span>
<span class="sd">                - &quot;regenerate_directory&quot;:Recalculate the user directory if it is stale or out of sync.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">(</span><span class="s2">&quot;background_updates/start_job&quot;</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;job_name&quot;</span><span class="p">:</span> <span class="n">job_name</span><span class="p">}</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">RequestMethods</span><span class="o">.</span><span class="n">POST</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h2 id="matrix_admin_sdk.endpoints.v1.background_updates.BackgroundUpdates.enabled" class="doc doc-heading">
<code class="highlight language-python"><span class="n">enabled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">enabled</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-async"><code>async</code></small>
  </span>

<a href="#matrix_admin_sdk.endpoints.v1.background_updates.BackgroundUpdates.enabled" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>This API allows pausing background updates.</p>
<p>Background updates should not be paused for significant periods of time,
as this can affect the performance of Synapse.</p>
<p>Note: This won't persist over restarts.</p>
<p>Note: This won't cancel any update query that is currently running.
This is usually fine since most queries are short lived, except for
CREATE INDEX background updates which won't be cancelled once started.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>enabled</code></td>
        <td><code>bool</code></td>
        <td><p>sets whether the background updates are enabled or disabled.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>      

        <details class="quote">
          <summary>Source code in <code>matrix_admin_sdk/endpoints/v1/background_updates.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">enabled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">enabled</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EnabledModel</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This API allows pausing background updates.</span>

<span class="sd">    Background updates should not be paused for significant periods of time,</span>
<span class="sd">    as this can affect the performance of Synapse.</span>

<span class="sd">    Note: This won&#39;t persist over restarts.</span>

<span class="sd">    Note: This won&#39;t cancel any update query that is currently running.</span>
<span class="sd">    This is usually fine since most queries are short lived, except for</span>
<span class="sd">    CREATE INDEX background updates which won&#39;t be cancelled once started.</span>
<span class="sd">    Args:</span>
<span class="sd">        enabled: sets whether the background updates are enabled or disabled.</span>

<span class="sd">    Returns: The new status of the background updates.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">(</span><span class="s2">&quot;background_updates/enabled&quot;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;enabled&quot;</span><span class="p">:</span> <span class="n">enabled</span><span class="p">}</span>
    <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">RequestMethods</span><span class="o">.</span><span class="n">POST</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
    <span class="n">res</span><span class="p">:</span> <span class="n">EnabledModel</span> <span class="o">=</span> <span class="n">EnabledModel</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h2 id="matrix_admin_sdk.endpoints.v1.background_updates.BackgroundUpdates.run" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">job_name</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-async"><code>async</code></small>
  </span>

<a href="#matrix_admin_sdk.endpoints.v1.background_updates.BackgroundUpdates.run" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>This API schedules a specific background update to run.
The job starts immediately after calling the API.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>job_name</code></td>
        <td><code>str</code></td>
        <td><p>A string which job to run. Valid values are:
- "populate_stats_process_rooms": Recalculate the stats for all rooms.
- "regenerate_directory":Recalculate the user directory if it is stale or out of sync.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>matrix_admin_sdk/endpoints/v1/background_updates.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">job_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This API schedules a specific background update to run.</span>
<span class="sd">    The job starts immediately after calling the API.</span>

<span class="sd">    Args:</span>
<span class="sd">        job_name: A string which job to run. Valid values are:</span>
<span class="sd">            - &quot;populate_stats_process_rooms&quot;: Recalculate the stats for all rooms.</span>
<span class="sd">            - &quot;regenerate_directory&quot;:Recalculate the user directory if it is stale or out of sync.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">(</span><span class="s2">&quot;background_updates/start_job&quot;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;job_name&quot;</span><span class="p">:</span> <span class="n">job_name</span><span class="p">}</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">RequestMethods</span><span class="o">.</span><span class="n">POST</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h2 id="matrix_admin_sdk.endpoints.v1.background_updates.BackgroundUpdates.status" class="doc doc-heading">
<code class="highlight language-python"><span class="n">status</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-async"><code>async</code></small>
  </span>

<a href="#matrix_admin_sdk.endpoints.v1.background_updates.BackgroundUpdates.status" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>This API gets the current status of the background updates.</p>

        <details class="quote">
          <summary>Source code in <code>matrix_admin_sdk/endpoints/v1/background_updates.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">status</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StatusModel</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This API gets the current status of the background updates.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">(</span><span class="s2">&quot;background_updates/status&quot;</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">RequestMethods</span><span class="o">.</span><span class="n">GET</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">StatusModel</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>

<h2 id="models">Models<a class="headerlink" href="#models" title="Permanent link">&para;</a></h2>
<h3 id="currentupdate">CurrentUpdate<a class="headerlink" href="#currentupdate" title="Permanent link">&para;</a></h3>


  <div class="doc doc-object doc-class">

<a id="matrix_admin_sdk.models.background_updates.CurrentUpdate"></a>
    <div class="doc doc-contents first">

      <p>CurrentUpdate</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>db_name</code></td>
        <td><code>str</code></td>
        <td><p>the database name (usually Synapse is configured with a single database named 'master')</p></td>
      </tr>
      <tr>
        <td><code>name</code></td>
        <td><code>str</code></td>
        <td><p>the name of the update</p></td>
      </tr>
      <tr>
        <td><code>total_item_count</code></td>
        <td><code>int</code></td>
        <td><p>total number of "items" processed (the meaning of
'items' depends on the update in question)</p></td>
      </tr>
      <tr>
        <td><code>total_duration_ms</code></td>
        <td><code>float</code></td>
        <td><p>how long the background process has been running,
not including time spent sleeping</p></td>
      </tr>
      <tr>
        <td><code>average_items_per_ms</code></td>
        <td><code>float</code></td>
        <td><p>how many items are processed per millisecond
based on an exponential average</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>matrix_admin_sdk/models/background_updates.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">CurrentUpdate</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    CurrentUpdate</span>

<span class="sd">    Attributes:</span>
<span class="sd">        db_name: the database name (usually Synapse is configured with a single database named &#39;master&#39;)</span>
<span class="sd">        name (str):  the name of the update</span>
<span class="sd">        total_item_count (int):total number of &quot;items&quot; processed (the meaning of</span>
<span class="sd">            &#39;items&#39; depends on the update in question)</span>
<span class="sd">        total_duration_ms (float): how long the background process has been running,</span>
<span class="sd">            not including time spent sleeping</span>
<span class="sd">        average_items_per_ms (float): how many items are processed per millisecond</span>
<span class="sd">            based on an exponential average</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">db_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">total_item_count</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">total_duration_ms</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">average_items_per_ms</span><span class="p">:</span> <span class="nb">float</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">



















  </div>

    </div>

  </div>

<h3 id="statusmodel">StatusModel<a class="headerlink" href="#statusmodel" title="Permanent link">&para;</a></h3>


  <div class="doc doc-object doc-class">

<a id="matrix_admin_sdk.models.background_updates.StatusModel"></a>
    <div class="doc doc-contents first">

      <p>StatusModel</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>enabled</code></td>
        <td><code>bool</code></td>
        <td><p>whether the background updates are enabled or disabled</p></td>
      </tr>
      <tr>
        <td><code>current_updates</code></td>
        <td><code>List[matrix_admin_sdk.models.background_updates.CurrentUpdate]</code></td>
        <td><p>a list of the current updates being processed</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>matrix_admin_sdk/models/background_updates.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">StatusModel</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    StatusModel</span>
<span class="sd">    Attributes:</span>
<span class="sd">        enabled: whether the background updates are enabled or disabled</span>
<span class="sd">        current_updates: a list of the current updates being processed</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">enabled</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">current_updates</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">CurrentUpdate</span><span class="p">]</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;StatusModel&quot;</span><span class="p">:</span>
        <span class="n">current_updates</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;current_updates&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">v</span><span class="p">[</span><span class="s2">&quot;db_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span>
            <span class="n">current_updates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CurrentUpdate</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">enabled</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;enabled&quot;</span><span class="p">],</span> <span class="n">current_updates</span><span class="o">=</span><span class="n">current_updates</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">

















  </div>

    </div>

  </div>

<h3 id="enabledmodel">EnabledModel<a class="headerlink" href="#enabledmodel" title="Permanent link">&para;</a></h3>


  <div class="doc doc-object doc-class">

<a id="matrix_admin_sdk.models.background_updates.EnabledModel"></a>
    <div class="doc doc-contents first">

      <p>EnabledModel</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>enabled</code></td>
        <td><code>bool</code></td>
        <td><p>whether the background updates are enabled or disabled</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>matrix_admin_sdk/models/background_updates.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">EnabledModel</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    EnabledModel</span>

<span class="sd">    Attributes:</span>
<span class="sd">        enabled (bool): whether the background updates are enabled or disabled</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">enabled</span><span class="p">:</span> <span class="nb">bool</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">















  </div>

    </div>

  </div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../account_validity/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Account Validity" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Account Validity
            </div>
          </div>
        </a>
      
      
        
        <a href="../delete_group/" class="md-footer__link md-footer__link--next" aria-label="Next: Delete Group" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Delete Group
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.5e67fbfe.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.c44cc438.min.js"></script>
      
    
  </body>
</html>