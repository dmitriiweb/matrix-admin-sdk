
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.8">
    
    
      
        <title>Purge History - Matrix Admin Sdk</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.644de097.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.e6a45f82.min.css">
        
          
          
          <meta name="theme-color" content="#e92063">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="pink" data-md-color-accent="pink">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#purge-history" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Matrix Admin Sdk" class="md-header__button md-logo" aria-label="Matrix Admin Sdk" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Matrix Admin Sdk
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Purge History
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Matrix Admin Sdk" class="md-nav__button md-logo" aria-label="Matrix Admin Sdk" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Matrix Admin Sdk
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Matrix Admin SDK
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Endpoints
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Endpoints" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Endpoints
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_1" type="checkbox" id="__nav_2_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2_1">
          v1
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="v1" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          v1
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../account_validity/" class="md-nav__link">
        Account Validity
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../background_updates/" class="md-nav__link">
        Background Updates
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../delete_group/" class="md-nav__link">
        Delete Group
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../delete_local_media/" class="md-nav__link">
        Delete Local Media
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../edit_room_membership/" class="md-nav__link">
        Edit Room Membership
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../event_reports/" class="md-nav__link">
        Event Reports
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Purge History
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Purge History
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#edpoints" class="md-nav__link">
    Edpoints
  </a>
  
    <nav class="md-nav" aria-label="Edpoints">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#purgehistory" class="md-nav__link">
    PurgeHistory
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matrix_admin_sdk.endpoints.v1.purge_history.PurgeHistory" class="md-nav__link">
    matrix_admin_sdk.endpoints.v1.purge_history.PurgeHistory
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matrix_admin_sdk.endpoints.v1.purge_history.PurgeHistory.purge_room_history" class="md-nav__link">
    purge_room_history()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matrix_admin_sdk.endpoints.v1.purge_history.PurgeHistory.purge_status_query" class="md-nav__link">
    purge_status_query()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../purge_remote_media/" class="md-nav__link">
        Purge Remote Media
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../quarantine_media/" class="md-nav__link">
        Quarantine Media
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../querying_media/" class="md-nav__link">
        Querying Media
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../register_user/" class="md-nav__link">
        Register Users
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../registration_tokens/" class="md-nav__link">
        Registration Tokens
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rooms/" class="md-nav__link">
        Rooms
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../forward_extremities/" class="md-nav__link">
        Forward Extremities
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../server_notices/" class="md-nav__link">
        Server Notices
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_media_statistics/" class="md-nav__link">
        User Media Statistics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user/" class="md-nav__link">
        User
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_rate_limits/" class="md-nav__link">
        User Rate Limits
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../server/" class="md-nav__link">
        Server
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../federation/" class="md-nav__link">
        Federation
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#edpoints" class="md-nav__link">
    Edpoints
  </a>
  
    <nav class="md-nav" aria-label="Edpoints">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#purgehistory" class="md-nav__link">
    PurgeHistory
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matrix_admin_sdk.endpoints.v1.purge_history.PurgeHistory" class="md-nav__link">
    matrix_admin_sdk.endpoints.v1.purge_history.PurgeHistory
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matrix_admin_sdk.endpoints.v1.purge_history.PurgeHistory.purge_room_history" class="md-nav__link">
    purge_room_history()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matrix_admin_sdk.endpoints.v1.purge_history.PurgeHistory.purge_status_query" class="md-nav__link">
    purge_status_query()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="purge-history">Purge History<a class="headerlink" href="#purge-history" title="Permanent link">&para;</a></h1>
<h2 id="edpoints">Edpoints<a class="headerlink" href="#edpoints" title="Permanent link">&para;</a></h2>
<h3 id="purgehistory"><a href="https://matrix-org.github.io/synapse/latest/admin_api/purge_history_api.html">PurgeHistory</a><a class="headerlink" href="#purgehistory" title="Permanent link">&para;</a></h3>


  <div class="doc doc-object doc-class">

<a id="matrix_admin_sdk.endpoints.v1.purge_history.PurgeHistory"></a>
    <div class="doc doc-contents first">

      <p>The purge history API allows server admins to purge historic events from
their database, reclaiming disk space.</p>
<p>Depending on the amount of history being purged a call to the API may take
several minutes or longer. During this period users will not be able to paginate
further back in the room from the point being purged from.</p>

        <details class="quote">
          <summary>Source code in <code>matrix_admin_sdk/endpoints/v1/purge_history.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">PurgeHistory</span><span class="p">(</span><span class="n">Endpoint</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The purge history API allows server admins to purge historic events from</span>
<span class="sd">    their database, reclaiming disk space.</span>

<span class="sd">    Depending on the amount of history being purged a call to the API may take</span>
<span class="sd">    several minutes or longer. During this period users will not be able to paginate</span>
<span class="sd">    further back in the room from the point being purged from.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">purge_room_history</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">room_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">event_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">delete_local_events</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">purge_up_to_event_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">purge_up_to_ts</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        By default, events sent by local users are not deleted, as they may</span>
<span class="sd">        represent the only copies of this content in existence. (Events sent by</span>
<span class="sd">        remote users are deleted.)</span>

<span class="sd">        Room state data (such as joins, leaves, topic) is always preserved.</span>

<span class="sd">        To delete local message events as well, set delete_local_events in the body</span>

<span class="sd">        The caller must specify the point in the room to purge up to. This can be</span>
<span class="sd">        specified by including an event_id in the URI, or by setting</span>
<span class="sd">        a purge_up_to_event_id or purge_up_to_ts in the request body.</span>
<span class="sd">        If an event id is given, that event (and others at the same graph depth)</span>
<span class="sd">        will be retained. If purge_up_to_ts is given, it should be a timestamp since</span>
<span class="sd">        the unix epoch, in milliseconds.</span>

<span class="sd">        The API starts the purge running, and returns immediately with a</span>
<span class="sd">        JSON body with a purge id</span>

<span class="sd">        Args:</span>
<span class="sd">            room_id: room id to purge history for</span>
<span class="sd">            event_id: event id</span>
<span class="sd">            delete_local_events: To delete local message events, Default: False</span>
<span class="sd">            purge_up_to_event_id</span>
<span class="sd">            purge_up_to_ts</span>

<span class="sd">        Returns: {&quot;purge_id&quot;: &quot;&lt;opaque id&gt;&quot;}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;purge_history/</span><span class="si">{</span><span class="n">room_id</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">event_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;delete_local_events&quot;</span><span class="p">:</span> <span class="n">delete_local_events</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">purge_up_to_event_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;purge_up_to_event_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">purge_up_to_event_id</span>
        <span class="k">if</span> <span class="n">purge_up_to_ts</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;purge_up_to_ts&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">purge_up_to_ts</span>

        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">RequestMethods</span><span class="o">.</span><span class="n">POST</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">purge_status_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">purge_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        It is possible to poll for updates on recent purges</span>
<span class="sd">        Args:</span>
<span class="sd">            purge_id:</span>

<span class="sd">        Returns: {&quot;status&quot;: &quot;active&quot;}. The status will be one of active,</span>
<span class="sd">            complete, or failed. If status is failed there will be a string</span>
<span class="sd">            error with the error message.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;purge_history_status/</span><span class="si">{</span><span class="n">purge_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">RequestMethods</span><span class="o">.</span><span class="n">GET</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h2 id="matrix_admin_sdk.endpoints.v1.purge_history.PurgeHistory.purge_room_history" class="doc doc-heading">
<code class="highlight language-python"><span class="n">purge_room_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">room_id</span><span class="p">,</span> <span class="n">event_id</span><span class="p">,</span> <span class="n">delete_local_events</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">purge_up_to_event_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">purge_up_to_ts</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-async"><code>async</code></small>
  </span>

<a href="#matrix_admin_sdk.endpoints.v1.purge_history.PurgeHistory.purge_room_history" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>By default, events sent by local users are not deleted, as they may
represent the only copies of this content in existence. (Events sent by
remote users are deleted.)</p>
<p>Room state data (such as joins, leaves, topic) is always preserved.</p>
<p>To delete local message events as well, set delete_local_events in the body</p>
<p>The caller must specify the point in the room to purge up to. This can be
specified by including an event_id in the URI, or by setting
a purge_up_to_event_id or purge_up_to_ts in the request body.
If an event id is given, that event (and others at the same graph depth)
will be retained. If purge_up_to_ts is given, it should be a timestamp since
the unix epoch, in milliseconds.</p>
<p>The API starts the purge running, and returns immediately with a
JSON body with a purge id</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>room_id</code></td>
        <td><code>str</code></td>
        <td><p>room id to purge history for</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>event_id</code></td>
        <td><code>str</code></td>
        <td><p>event id</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>delete_local_events</code></td>
        <td><code>bool</code></td>
        <td><p>To delete local message events, Default: False</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>      

        <details class="quote">
          <summary>Source code in <code>matrix_admin_sdk/endpoints/v1/purge_history.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">purge_room_history</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">room_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">event_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">delete_local_events</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">purge_up_to_event_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">purge_up_to_ts</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    By default, events sent by local users are not deleted, as they may</span>
<span class="sd">    represent the only copies of this content in existence. (Events sent by</span>
<span class="sd">    remote users are deleted.)</span>

<span class="sd">    Room state data (such as joins, leaves, topic) is always preserved.</span>

<span class="sd">    To delete local message events as well, set delete_local_events in the body</span>

<span class="sd">    The caller must specify the point in the room to purge up to. This can be</span>
<span class="sd">    specified by including an event_id in the URI, or by setting</span>
<span class="sd">    a purge_up_to_event_id or purge_up_to_ts in the request body.</span>
<span class="sd">    If an event id is given, that event (and others at the same graph depth)</span>
<span class="sd">    will be retained. If purge_up_to_ts is given, it should be a timestamp since</span>
<span class="sd">    the unix epoch, in milliseconds.</span>

<span class="sd">    The API starts the purge running, and returns immediately with a</span>
<span class="sd">    JSON body with a purge id</span>

<span class="sd">    Args:</span>
<span class="sd">        room_id: room id to purge history for</span>
<span class="sd">        event_id: event id</span>
<span class="sd">        delete_local_events: To delete local message events, Default: False</span>
<span class="sd">        purge_up_to_event_id</span>
<span class="sd">        purge_up_to_ts</span>

<span class="sd">    Returns: {&quot;purge_id&quot;: &quot;&lt;opaque id&gt;&quot;}</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;purge_history/</span><span class="si">{</span><span class="n">room_id</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">event_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;delete_local_events&quot;</span><span class="p">:</span> <span class="n">delete_local_events</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="n">purge_up_to_event_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;purge_up_to_event_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">purge_up_to_event_id</span>
    <span class="k">if</span> <span class="n">purge_up_to_ts</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;purge_up_to_ts&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">purge_up_to_ts</span>

    <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">RequestMethods</span><span class="o">.</span><span class="n">POST</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h2 id="matrix_admin_sdk.endpoints.v1.purge_history.PurgeHistory.purge_status_query" class="doc doc-heading">
<code class="highlight language-python"><span class="n">purge_status_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">purge_id</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-async"><code>async</code></small>
  </span>

<a href="#matrix_admin_sdk.endpoints.v1.purge_history.PurgeHistory.purge_status_query" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>It is possible to poll for updates on recent purges</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>purge_id</code></td>
        <td><code>str</code></td>
        <td></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>      <div class="admonition returns">
<p class="admonition-title">{"status": "active"}. The status will be one of active,</p>
<p>complete, or failed. If status is failed there will be a string
error with the error message.</p>
</div>

        <details class="quote">
          <summary>Source code in <code>matrix_admin_sdk/endpoints/v1/purge_history.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">purge_status_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">purge_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    It is possible to poll for updates on recent purges</span>
<span class="sd">    Args:</span>
<span class="sd">        purge_id:</span>

<span class="sd">    Returns: {&quot;status&quot;: &quot;active&quot;}. The status will be one of active,</span>
<span class="sd">        complete, or failed. If status is failed there will be a string</span>
<span class="sd">        error with the error message.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;purge_history_status/</span><span class="si">{</span><span class="n">purge_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">RequestMethods</span><span class="o">.</span><span class="n">GET</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../event_reports/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Event Reports" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Event Reports
            </div>
          </div>
        </a>
      
      
        
        <a href="../purge_remote_media/" class="md-footer__link md-footer__link--next" aria-label="Next: Purge Remote Media" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Purge Remote Media
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.5e67fbfe.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.c44cc438.min.js"></script>
      
    
  </body>
</html>